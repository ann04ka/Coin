# Определение монет с использованием CNN

## Обзор
Этот проект реализует алгоритм для определения монет на изображении и классификации их как "Орел" или "Всадник" с использованием сверточной нейронной сети (CNN). Алгоритм включает бинаризацию изображения, нахождение контуров, выделение прямоугольников вокруг монет и классификацию каждой монеты.

## Алгоритм работы
1. **Входное изображение**: Исходное изображение подается на вход алгоритма.
2. **Бинаризация**: Изображение бинаризуется методом Отцу.
3. **Нахождение контуров**: На бинаризованном изображении находятся внешние контуры и их площади.
4. **Маска**: На исходное изображение накладывается маска, полученная из контурного препарата.
5. **Выделение прямоугольников**: Вырезается наименьший прямоугольник вокруг каждого контура.
6. **Классификация**: Каждое из полученных изображений отправляется на вход модели CNN, которая выносит решение "Орел" или "Всадник" для каждого прямоугольника.

## Задача 1: Определение площади монет
Определить и вывести в консоль площадь (в пикселях) каждой монеты и общую площадь всех монет.

### Изображения на каждом этапе алгоритма

**Исходное изображение в оттенках серого**
![Исходное](https://github.com/ann04ka/Coin_cvlab/blob/master/Gray.jpg)

**Бинаризованное изображение методом Отцу**
![Бинаризованное методом Отцу](https://github.com/ann04ka/Coin_cvlab/blob/master/Otsu.jpg)

**Внешние контуры монет с площадью**
![Внешние контуры монет](https://github.com/ann04ka/Coin_cvlab/blob/master/Area.jpg)

**Контурный препарат на основе найденных контуров**
![Контурный препарат](https://github.com/ann04ka/Coin_cvlab/blob/master/Masked.jpg)

**Результат после 1 этапа**
![Результат](https://github.com/ann04ka/Coin_cvlab/blob/master/data/img/O/3_Bbox1.jpg)

## Задача 2: Классификация монет
Реализовать алгоритм, отличающий монеты с орлом от монет с всадником.

### Решение
Для решения задачи используется маленькая сверточная нейронная сеть, состоящая из 3 сверток, MaxPooling и 2 полносвязных слоев.

### Предобработка изображения
При чтении изображение преобразуется в квадратное размером 64x64 пикселей.
